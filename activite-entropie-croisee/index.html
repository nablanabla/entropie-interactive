<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L'Entropie Crois√©e - Activit√© Interactive</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <!-- KaTeX JS (sans defer !) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <!-- Auto-render extension (sans defer !) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #e94560;
            --success: #06d6a0;
            --warning: #ffd166;
            --text: #f1f1f1;
            --text-dim: #a8a8b3;
            --card-bg: #0f3460;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 2rem 1rem;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--accent), var(--warning));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            margin: 2rem 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--warning));
            border-radius: 20px;
            width: 0%;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(30px);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .section.completed {
            opacity: 0.6;
            pointer-events: none;
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: var(--warning);
            font-weight: 600;
        }

        h3 {
            font-size: 1.4rem;
            margin: 1.5rem 0 1rem;
            color: var(--success);
            font-weight: 600;
        }

        .scenario {
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            border-left: 4px solid var(--accent);
        }

        .formula-box {
            background: rgba(0, 0, 0, 0.4);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
            border: 2px solid var(--warning);
            text-align: center;
        }

        .formula {
            font-family: 'Space Mono', monospace;
            font-size: 1.5rem;
            color: var(--warning);
            margin: 1rem 0;
            font-weight: 700;
        }

        .info-box {
            background: rgba(255, 209, 102, 0.15);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
        }

        .info-box strong {
            color: var(--warning);
        }

        .diagnostic-container {
            display: grid;
            gap: 1rem;
            margin: 2rem 0;
        }

        .diagnostic-row {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            display: grid;
            grid-template-columns: 150px 1fr 1fr 1fr;
            gap: 1rem;
            align-items: center;
        }

        .diagnostic-label {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .prob-bar-container {
            position: relative;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .prob-bar {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-family: 'Space Mono', monospace;
            transition: width 0.6s ease-out;
        }

        .prob-bar.expert {
            background: linear-gradient(90deg, var(--success), #04a777);
        }

        .prob-bar.student1 {
            background: linear-gradient(90deg, #6a89cc, #4a69bd);
        }

        .prob-bar.student2 {
            background: linear-gradient(90deg, #e94560, #c44569);
        }

        .metric-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid var(--accent);
        }

        .metric-value {
            font-family: 'Space Mono', monospace;
            font-size: 1.8rem;
            color: var(--warning);
            font-weight: 700;
        }

        .button {
            background: linear-gradient(135deg, var(--accent), #c44569);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Crimson Pro', serif;
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.3);
            margin-top: 1.5rem;
        }

        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(233, 69, 96, 0.5);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .table-container {
            overflow-x: auto;
            margin: 2rem 0;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            overflow: hidden;
        }

        th {
            background: rgba(233, 69, 96, 0.2);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        td {
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .student-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: var(--transition);
        }

        .student-card.student1 {
            border-color: #6a89cc;
        }

        .student-card.student2 {
            border-color: var(--accent);
        }

        .completion-message {
            text-align: center;
            padding: 3rem;
            background: linear-gradient(135deg, rgba(6, 214, 160, 0.2), rgba(255, 209, 102, 0.2));
            border-radius: 16px;
            margin-top: 2rem;
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: celebrate 1s ease-out;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-10deg); }
            75% { transform: scale(1.2) rotate(10deg); }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .training-step {
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid var(--success);
        }

        .loss-graph {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .section {
                padding: 1.5rem;
            }

            .diagnostic-row {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>L'Entropie Crois√©e</h1>
            <p class="subtitle">Mesurer la distance entre distributions</p>
        </header>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <!-- Section 1: Introduction -->
        <div class="section active" id="section1">
            <h2>üéØ Le probl√®me</h2>
            <div class="scenario">
                <p><strong>Question centrale :</strong> Comment mesurer l'√©cart entre deux distributions de probabilit√© ?</p>
                <p style="margin-top: 1rem;">Par exemple :</p>
                <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                    <li>La distribution pr√©dite par un mod√®le vs la distribution id√©ale</li>
                    <li>L'estimation d'un √©tudiant vs l'avis d'un expert</li>
                    <li>Les probabilit√©s d'apparition du prochain token calcul√© par un LLM vs la probabilit√© observ√©e dans le corpus d'entrainement</li>
                </ul>
            </div>

            <h2>üîë La solution</h2>

            <h3> L'id√©e de l'<em>entropie crois√©e</em> est d'ajouter quelque chose √† l'entropie apport√©e par P quand on utilise P au lieu de Q</h3>
            <h3> Les formules sont √©crites √† titre indicatif pour formaliser cette id√©e au coeur de l'apprentissage machine</h3>
            <div class="formula-box">
                <p><strong>Entropie crois√©e entre P (vraie) et Q (pr√©dite) :</strong></p>
                <div style="font-size: 1.3rem; margin: 1rem 0;margin-bottom: 3rem; text-align: center;">
                $$H(P,Q) = \underbrace{H(P)}_{\text{Entropie de la distribution P}} + \underbrace{D_{KL}(P \parallel Q)}_{\text{surplus d'entropie apport√© par Q}}$$
                </div>
                
                <div style="font-size: 1rem; margin-top: 1rem; text-align: left;">
                     o√π $D_{KL}(P \parallel Q) = \displaystyle \sum_i P_i \log_2\frac{P_i}{Q_i}$ est la divergence de Kullback-Leibler
                </div>
            </div>

            <div class="info-box">
                <p><strong>üîë Propri√©t√© fondamentale :</p>
            
                <p style="margin-top: 0.5rem;"></p>‚Ä¢ $D_{KL}(P \parallel Q)\geq 0$</p>
                <p style="font-size: 1.3rem;margin-top: 0.5rem;">‚Ä¢ $D_{KL}(P \parallel Q)= 0$ si et seulement si P = Q, donc la
                    divergence de Kullback-Leibler mesure bien √† quel point ¬´P est proche de Q¬ª</p>
            
            </div>

            <div class="info-box">
                <p><strong>üí° Interpr√©tation :</strong> L'entropie crois√©e mesure l'<strong>incertitude moyenne</strong> qu'on
                    ressent quand on utilise une mauvaise distribution (Q) pour pr√©dire des √©v√©nements qui suivent la vraie
                    distribution (P).</p>
                <div class="table-container" style="margin: 1.5rem 0;">
                    <table>
                        <thead>
                            <tr>
                                <th>Cas</th>
                                <th>Divergence de Kullback-Leibler</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Q = P</strong><br><span style="color: var(--text-dim); font-size: 0.9rem;">Pr√©diction
                                        parfaite</span></td>
                                <td style="color: var(--success); font-weight: 600; font-size: 1.1rem;">$D_{KL}(P \parallel Q) = 0$</td>
                            </tr>
                            <tr>
                                <td><strong>Q proche de P</strong><br><span
                                        style="color: var(--text-dim); font-size: 0.9rem;">Pr√©diction correcte</span></td>
                                <td style="color: var(--warning); font-weight: 600; font-size: 1.1rem;">$D_{KL}(P \parallel Q)$ faible
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Q loin de P</strong><br><span style="color: var(--text-dim); font-size: 0.9rem;">Pr√©diction
                                        incorrecte</span></td>
                                <td style="color: var(--accent); font-weight: 600; font-size: 1.1rem;">$D_{KL}(P \parallel Q)$ √©lev√©
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p style="margin-top: 1rem;"><strong>En m√©decine :</strong> Un √©tudiant qui se trompe sur les probabilit√©s des
                    diagnostics devra poser <strong>plus de questions</strong> en moyenne pour arriver au bon diagnostic.
              
            </div>
        </div>

            

            <button class="button" onclick="nextSection(2)">Voir un exemple concret ‚Üí</button>
        

        <!-- Section 2: Cas m√©dical -->
        <div class="section" id="section2">
            <h2>ü©∫ Cas pratique : Diagnostic m√©dical</h2>
            
            <div class="scenario">
                <p><strong>Contexte :</strong> Un patient pr√©sente des sympt√¥mes. Un expert analyse le cas et donne sa distribution de probabilit√© pour 4 diagnostics possibles.</p>
                <p style="margin-top: 1rem;">Deux √©tudiants en m√©decine (√âtudiant 1 et √âtudiant 2) donnent √©galement leur estimation.</p>
            </div>

            <h3>Les distributions de probabilit√©</h3>
            
            <div class="diagnostic-container">
                <div class="diagnostic-row" style="grid-template-columns: 150px 120px 120px 120px 120px; font-weight: 600; background: rgba(255, 209, 102, 0.1);">
                    <div></div>
                    <div>D‚ÇÅ</div>
                    <div>D‚ÇÇ</div>
                    <div>D‚ÇÉ</div>
                    <div>D‚ÇÑ</div>
                </div>

                <div class="diagnostic-row" style="grid-template-columns: 150px 120px 120px 120px 120px;">
                    <div class="diagnostic-label" style="color: var(--success);">Expert (P)</div>
                    <div>0.80</div>
                    <div>0.10</div>
                    <div>0.05</div>
                    <div>0.05</div>
                </div>

                <div class="diagnostic-row" style="grid-template-columns: 150px 120px 120px 120px 120px;">
                    <div class="diagnostic-label" style="color: #6a89cc;">√âtudiant 1</div>
                    <div>0.50</div>
                    <div>0.20</div>
                    <div>0.15</div>
                    <div>0.15</div>
                </div>

                <div class="diagnostic-row" style="grid-template-columns: 150px 120px 120px 120px 120px;">
                    <div class="diagnostic-label" style="color: var(--accent);">√âtudiant 2 </div>
                    <div>0.25</div>
                    <div>0.25</div>
                    <div>0.25</div>
                    <div>0.25</div>
                </div>
            </div>

            <h3>Visualisation des distributions</h3>
            <div style="background: rgba(0, 0, 0, 0.2); padding: 1.5rem; border-radius: 10px; margin: 1.5rem 0;">
                <div style="margin-bottom: 1.5rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--success);">Expert (P)</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                        <div class="prob-bar-container"><div class="prob-bar expert" style="width: 100%;">80%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar expert" style="width: 12.5%;">10%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar expert" style="width: 6.25%;">5%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar expert" style="width: 6.25%;">5%</div></div>
                    </div>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <div style="font-weight: 600; margin-bottom: 0.5rem; color: #6a89cc;">√âtudiant 1 (R‚ÇÅ)</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                        <div class="prob-bar-container"><div class="prob-bar student1" style="width: 62.5%;">50%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student1" style="width: 25%;">20%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student1" style="width: 18.75%;">15%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student1" style="width: 18.75%;">15%</div></div>
                    </div>
                </div>

                <div>
                    <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--accent);">√âtudiant 2 (R‚ÇÇ)</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                        <div class="prob-bar-container"><div class="prob-bar student2" style="width: 31.25%;">25%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student2" style="width: 31.25%;">25%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student2" style="width: 31.25%;">25%</div></div>
                        <div class="prob-bar-container"><div class="prob-bar student2" style="width: 31.25%;">25%</div></div>
                    </div>
                </div>
            </div>
            <h3>Nous allons comparer deux m√©triques :</h3>
            <ul style="margin-left: 2rem; margin-top: 1rem; line-height: 1.8;">
                <li><strong>Distance L1</strong> : L'√©cart num√©rique absolu entre les distributions (approche intuitive)</li>
                <li><strong>Divergence KL</strong> : L'entropie crois√©e qui mesure l'√©cart en termes d'information</li>
            </ul>


            <button class="button" onclick="nextSection(3)">Calculer les m√©triques ‚Üí</button>
        </div>

        <!-- Section 3: Comparaison -->
        <div class="section" id="section3">
            <h2>üìä Comparaison des erreurs</h2>

            <h3>√âcart en valeur absolue</h3>
            <p>Somme des diff√©rences absolues : |P<sub>i</sub> - Q<sub>i</sub>|</p>

            <div class="comparison-grid">
                <div class="student-card student1">
                    <h3 style="color: #6a89cc; margin-top: 0;">√âtudiant 1</h3>
                    <div style="font-family: 'Space Mono', monospace; font-size: 0.9rem; margin: 1rem 0;">
                        |0.80-0.50| + |0.10-0.20| + |0.05-0.15| + |0.05-0.15|<br>
                        = 0.30 + 0.10 + 0.10 + 0.10
                    </div>
                    <div class="metric-value">= 0.60</div>
                </div>

                <div class="student-card student2">
                    <h3 style="color: var(--accent); margin-top: 0;">√âtudiant 2</h3>
                    <div style="font-family: 'Space Mono', monospace; font-size: 0.9rem; margin: 1rem 0;">
                        |0.80-0.25| + |0.10-0.25| + |0.05-0.25| + |0.05-0.25|<br>
                        = 0.55 + 0.15 + 0.20 + 0.20
                    </div>
                    <div class="metric-value">= 1.10</div>
                </div>
            </div>

            <div class="info-box">
                <p><strong>Premier constat :</strong> L'√©tudiant 2 a un √©cart <strong>1.83√ó plus grand</strong> (1.10 vs 0.60)</p>
            </div>

            <h3>Divergence de Kullback-Leibler</h3>
            <p>$D_{KL}(P \parallel Q) =  \sum_i P_i \log_2\frac{P_i}{Q_i}$</p>

            <div class="comparison-grid">
                <div class="student-card student1">
                    <h3 style="color: #6a89cc; margin-top: 0;">√âtudiant 1</h3>
                    <div style="font-family: 'Space Mono', monospace; font-size: 0.85rem; margin: 1rem 0; line-height: 1.8;">
                        = 0.80 √ó log‚ÇÇ(0.80/0.50)<br>
                        + 0.10 √ó log‚ÇÇ(0.10/0.20)<br>
                        + 0.05 √ó log‚ÇÇ(0.05/0.15)<br>
                        + 0.05 √ó log‚ÇÇ(0.05/0.15)<br>
                        <span style="color: var(--text-dim);">
                        = 0.80 √ó 0.678<br>
                        + 0.10 √ó (-1.000)<br>
                        + 0.05 √ó (-1.585)<br>
                        + 0.05 √ó (-1.585)
                        </span>
                    </div>
                    <div class="metric-value">= 0.197 bits</div>
                </div>

                <div class="student-card student2">
                    <h3 style="color: var(--accent); margin-top: 0;">√âtudiant 2</h3>
                    <div style="font-family: 'Space Mono', monospace; font-size: 0.85rem; margin: 1rem 0; line-height: 1.8;">
                        = 0.80 √ó log‚ÇÇ(0.80/0.25)<br>
                        + 0.10 √ó log‚ÇÇ(0.10/0.25)<br>
                        + 0.05 √ó log‚ÇÇ(0.05/0.25)<br>
                        + 0.05 √ó log‚ÇÇ(0.05/0.25)<br>
                        <span style="color: var(--text-dim);">
                        = 0.80 √ó 1.678<br>
                        + 0.10 √ó (-1.322)<br>
                        + 0.05 √ó (-2.322)<br>
                        + 0.05 √ó (-2.322)
                        </span>
                    </div>
                    <div class="metric-value">= 0.678 bits</div>
                </div>
            </div>

            <div class="info-box" style="background: rgba(233, 69, 96, 0.15); border-left: 4px solid var(--accent);">
                <p><strong>üéØ Constat crucial :</strong></p>
                <p style="margin-top: 0.5rem;">L'√©tudiant 2 a une divergence KL <strong>3.45√ó plus grande</strong> (0.678 vs 0.197)</p>
                <p style="margin-top: 1rem;">Alors que son √©cart en valeur absolue n'√©tait que 1.83√ó plus grand !</p>
            </div>

            <button class="button" onclick="nextSection(4)">Comprendre pourquoi ‚Üí</button>
        </div>

        <!-- Section 4: Explication -->
        <div class="section" id="section4">
            <h2>üîç Pourquoi cette diff√©rence ?</h2>

            <div class="scenario">
                <p><strong>La divergence KL p√©nalise fortement les grosses erreurs sur les √©v√©nements probables.</strong></p>
            </div>

            <h3>Analyse du terme probl√©matique</h3>
            
            <div class="metric-box" style="border-left-color: var(--accent);">
                <p><strong>Pour le diagnostic D‚ÇÅ (le plus probable : 80%) :</strong></p>
                <div style="margin-top: 1rem; font-family: 'Space Mono', monospace;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div style="background: rgba(106, 137, 204, 0.2); padding: 1rem; border-radius: 8px;">
                            <div style="color: #6a89cc; font-weight: 600;">√âtudiant 1</div>
                            <div style="margin-top: 0.5rem;">Estime : 0.50</div>
                            <div style="margin-top: 0.5rem; color: var(--warning);">
                                Contribution : 0.80 √ó log‚ÇÇ(1.6) = 0.542 bits
                            </div>
                        </div>
                        <div style="background: rgba(233, 69, 96, 0.2); padding: 1rem; border-radius: 8px;">
                            <div style="color: var(--accent); font-weight: 600;">√âtudiant 2</div>
                            <div style="margin-top: 0.5rem;">Estime : 0.25 ‚ö†Ô∏è</div>
                            <div style="margin-top: 0.5rem; color: var(--accent); font-weight: 600;">
                                Contribution : 0.80 √ó log‚ÇÇ(3.2) = 1.342 bits
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <p><strong>üí° Principe cl√© :</strong></p>
                <p style="margin-top: 0.5rem;">Sous-estimer un √©v√©nement <strong>tr√®s probable</strong> co√ªte extr√™mement cher en termes d'information.</p>
                <p style="margin-top: 1rem;">L'√©tudiant 2 propose une distribution <strong>uniforme</strong> (25% partout), ignorant compl√®tement la forte probabilit√© de D‚ÇÅ !</p>
            </div>

            <h3>Comparaison visuelle : Distance absolue vs KL</h3>
            <div style="background: white; padding: 2rem; border-radius: 10px; margin: 2rem 0;">
                <canvas id="logGraph" width="700" height="450" style="max-width: 100%;"></canvas>
            </div>

            <div class="info-box">
                <p><strong>Interpr√©tation du graphique :</strong></p>
                <p style="margin-top: 0.5rem;"><strong>Distance L1</strong> (barre bleue) : mesure l'√©cart absolu total, traite toutes les erreurs √©galement.</p>
                <p style="margin-top: 0.5rem;"><strong>Divergence KL</strong> (courbe rouge) : p√©nalise exponentiellement quand on sous-estime un √©v√©nement probable.</p>
                <p style="margin-top: 1rem;">Plus le ratio $\frac{P_i}{Q_i}$ est grand, plus la p√©nalit√© logarithmique explose.</p>
                <p style="margin-top: 1rem;">C'est pourquoi l'entropie crois√©e est une excellente fonction de perte pour l'apprentissage automatique : elle p√©nalise s√©v√®rement les pr√©dictions confiantes mais fausses.</p>
            </div>

            <button class="button" onclick="nextSection(5)">Voir l'application en IA ‚Üí</button>
        </div>

        <!-- Section 5: Application LLM -->
        <div class="section" id="section5">
            <h2>ü§ñ Application : Entra√Ænement d'un LLM</h2>

            <div class="scenario">
                <p><strong>Contexte :</strong> Un mod√®le de langage apprend √† pr√©dire le mot suivant.</p>
                <p style="margin-top: 1rem;"><strong>Phrase d'entra√Ænement :</strong> "Le chat dort sur le ____"</p>
                <p style="margin-top: 0.5rem;"><strong>Mot r√©el :</strong> "canap√©" (probabilit√© 1.0)</p>
            </div>

            <h3>√âvolution pendant l'entra√Ænement</h3>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>√âpoque</th>
                            <th>Pr√©diction "canap√©"</th>
                            <th>Pr√©diction "tapis"</th>
                            <th>Pr√©diction "lit"</th>
                            <th>Cross-Entropy</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>0</strong> (initial)</td>
                            <td>0.10</td>
                            <td>0.40</td>
                            <td>0.50</td>
                            <td style="color: var(--accent); font-weight: 700;">3.322 bits</td>
                        </tr>
                        <tr>
                            <td><strong>10</strong></td>
                            <td>0.25</td>
                            <td>0.35</td>
                            <td>0.40</td>
                            <td style="color: var(--warning); font-weight: 700;">2.000 bits</td>
                        </tr>
                        <tr>
                            <td><strong>50</strong></td>
                            <td>0.50</td>
                            <td>0.30</td>
                            <td>0.20</td>
                            <td style="color: var(--warning); font-weight: 700;">1.000 bits</td>
                        </tr>
                        <tr>
                            <td><strong>100</strong></td>
                            <td>0.70</td>
                            <td>0.20</td>
                            <td>0.10</td>
                            <td style="color: var(--success); font-weight: 700;">0.515 bits</td>
                        </tr>
                        <tr>
                            <td><strong>200</strong></td>
                            <td>0.90</td>
                            <td>0.07</td>
                            <td>0.03</td>
                            <td style="color: var(--success); font-weight: 700;">0.152 bits</td>
                        </tr>
                        <tr>
                            <td><strong>500</strong></td>
                            <td>0.98</td>
                            <td>0.01</td>
                            <td>0.01</td>
                            <td style="color: var(--success); font-weight: 700;">0.029 bits</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="background: white; padding: 2rem; border-radius: 10px; margin: 2rem 0;">
                <canvas id="trainingGraph" width="700" height="400" style="max-width: 100%;"></canvas>
            </div>

            <div class="info-box">
                <p><strong>üìâ Observation :</strong> La cross-entropy diminue progressivement √† mesure que le mod√®le apprend.</p>
                <p style="margin-top: 1rem;"><strong>Objectif :</strong> Minimiser H(P, Q) = -log‚ÇÇ(Q("canap√©")) quand P("canap√©") = 1</p>
                <p style="margin-top: 1rem;">Plus le mod√®le est confiant dans la bonne pr√©diction, plus la loss est faible.</p>
            </div>

            <button class="button" onclick="completeActivity()">Terminer l'activit√© ‚Üí</button>
        </div>

        <!-- Section finale -->
        <div class="section" id="completion" style="display: none;">
            <div class="completion-message">
                <div class="completion-icon">üéâ</div>
                <h2 style="color: var(--success);">F√©licitations !</h2>
                <p style="margin-top: 1rem; font-size: 1.2rem;">Vous ma√Ætrisez maintenant le concept d'entropie crois√©e et son r√¥le fondamental en apprentissage automatique.</p>
                
                <div style="text-align: left; margin-top: 2rem; background: rgba(0, 0, 0, 0.2); padding: 2rem; border-radius: 10px;">
                    <h3 style="color: var(--warning); margin-top: 0;">üîó Ce que vous avez appris :</h3>
                    <ul style="margin-left: 2rem; margin-top: 1rem; line-height: 2;">
                        <li>La d√©finition de l'entropie crois√©e H(P,Q)</li>
                        <li>La divergence de Kullback-Leibler et sa signification</li>
                        <li>Pourquoi cette m√©trique punit la sous-estimation d'un √©v√©nement probable</li>
                        <li>Comment l'entropie crois√©e guide l'entra√Ænement des LLMs</li>
                        <li>Le lien entre th√©orie de l'information et IA moderne</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSection = 1;
        let totalSections = 5;

        function nextSection(sectionNum) {
            const current = document.getElementById(`section${currentSection}`);
            current.classList.remove('active');
            current.classList.add('completed');
            
            currentSection = sectionNum;
            const next = document.getElementById(`section${sectionNum}`);
            next.classList.add('active');
            
            updateProgress();
            next.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Draw graphs when reaching appropriate sections
            if (sectionNum === 4) {
                setTimeout(drawLogGraph, 100);
            }
            if (sectionNum === 5) {
                setTimeout(drawTrainingGraph, 100);
            }
        }

        function updateProgress() {
            const progress = (currentSection / totalSections) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function completeActivity() {
            document.getElementById('section5').classList.remove('active');
            document.getElementById('section5').classList.add('completed');
            document.getElementById('completion').style.display = 'block';
            document.getElementById('completion').classList.add('active');
            currentSection = 6;
            updateProgress();
            document.getElementById('completion').scrollIntoView({ behavior: 'smooth' });
        }

        function drawLogGraph() {
            const canvas = document.getElementById('logGraph');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const margin = { top: 50, right: 40, bottom: 70, left: 80 };
            const graphWidth = width - margin.left - margin.right;
            const graphHeight = height - margin.top - margin.bottom;
            
            // Clear
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, width, height);
            
            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.stroke();
            
            // Function: Pi * log2(Pi/Ri) for KL divergence
            // And |Pi - Ri| for L1 distance
            // Let's plot for Pi = 0.8 (expert's probability for D1)
            const Pi = 0.8;
            const xMin = 0.01, xMax = 1.0;
            const yMax = 2.5; // Increased to fit both metrics
            
            const xToCanvas = (x) => margin.left + ((x - xMin) / (xMax - xMin)) * graphWidth;
            const yToCanvas = (y) => height - margin.bottom - (y / yMax) * graphHeight;
            
            // Grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            for (let y = 0; y <= 2.5; y += 0.5) {
                ctx.beginPath();
                ctx.moveTo(margin.left, yToCanvas(y));
                ctx.lineTo(width - margin.right, yToCanvas(y));
                ctx.stroke();
            }
            
            // Y-axis labels
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            for (let y = 0; y <= 2.5; y += 0.5) {
                ctx.fillText(y.toFixed(1), margin.left - 10, yToCanvas(y));
            }
            
            // X-axis labels
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            for (let x = 0.2; x <= 1.0; x += 0.2) {
                const canvasX = xToCanvas(x);
                ctx.fillText(x.toFixed(1), canvasX, height - margin.bottom + 10);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(canvasX, height - margin.bottom);
                ctx.lineTo(canvasX, height - margin.bottom + 5);
                ctx.stroke();
            }
            
            // Labels
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('x=probabilit√© estim√©e du diagnostique 1', width / 2, height - 20);
            
            ctx.save();
            ctx.translate(25, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = 'center';
            ctx.fillText('Mesure de l\'erreur', 0, 0);
            ctx.restore();
            
            // Plot L1 distance curve: |Pi - Ri|
            ctx.strokeStyle = '#4169E1';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            let firstPoint = true;
            for (let Ri = xMin; Ri <= xMax; Ri += 0.001) {
                const l1 = Math.abs(Pi - Ri);
                if (l1 >= 0 && l1 <= yMax) {
                    const x = xToCanvas(Ri);
                    const y = yToCanvas(l1);
                    
                    if (firstPoint) {
                        ctx.moveTo(x, y);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
            }
            ctx.stroke();
            
            // Plot KL divergence curve: Pi * log2(Pi/Ri)
            ctx.strokeStyle = '#e94560';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            firstPoint = true;
            for (let Ri = xMin; Ri <= xMax; Ri += 0.001) {
                const kl = Pi * Math.log2(Pi / Ri);
                if (kl >= -0.5 && kl <= yMax) {
                    const x = xToCanvas(Ri);
                    const y = yToCanvas(kl);
                    
                    if (firstPoint) {
                        ctx.moveTo(x, y);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
            }
            ctx.stroke();
            
            // Mark student points for L1
            // Student 1: R1 = 0.5, L1 = |0.8 - 0.5| = 0.3
            const R1 = 0.5;
            const l1_1 = Math.abs(Pi - R1);
            ctx.fillStyle = '#4169E1';
            ctx.beginPath();
            ctx.arc(xToCanvas(R1), yToCanvas(l1_1), 7, 0, 2 * Math.PI);
            ctx.fill();
            
            // Student 2: R2 = 0.25, L1 = |0.8 - 0.25| = 0.55
            const R2 = 0.25;
            const l1_2 = Math.abs(Pi - R2);
            ctx.fillStyle = '#4169E1';
            ctx.beginPath();
            ctx.arc(xToCanvas(R2), yToCanvas(l1_2), 7, 0, 2 * Math.PI);
            ctx.fill();
            
            // Mark student points for KL
            // Student 1: R1 = 0.5, KL = 0.8 * log2(0.8/0.5) = 0.542
            const kl_1 = Pi * Math.log2(Pi / R1);
            ctx.fillStyle = '#e94560';
            ctx.beginPath();
            ctx.arc(xToCanvas(R1), yToCanvas(kl_1), 7, 0, 2 * Math.PI);
            ctx.fill();
            
            // Student 2: R2 = 0.25, KL = 0.8 * log2(0.8/0.25) = 1.342
            const kl_2 = Pi * Math.log2(Pi / R2);
            ctx.fillStyle = '#e94560';
            ctx.beginPath();
            ctx.arc(xToCanvas(R2), yToCanvas(kl_2), 7, 0, 2 * Math.PI);
            ctx.fill();
            
            // Add labels for students
            ctx.fillStyle = '#333';
            ctx.font = '13px Arial';
            ctx.textAlign = 'center';
            
            // Student 1 label
            ctx.fillText('√âtud. 1', xToCanvas(R1), yToCanvas(Math.max(l1_1, kl_1)) - 25);
            ctx.fillStyle = '#4169E1';
            ctx.font = '11px Arial';
            ctx.fillText('L1: 0.30', xToCanvas(R1), yToCanvas(l1_1) + 15);
            ctx.fillStyle = '#e94560';
            ctx.fillText('KL: 0.54', xToCanvas(R1), yToCanvas(kl_1) - 15);
            
            // Student 2 label
            ctx.fillStyle = '#333';
            ctx.font = '13px Arial';
            ctx.fillText('√âtud. 2', xToCanvas(R2), yToCanvas(kl_2) - 40);
            ctx.fillStyle = '#4169E1';
            ctx.font = '11px Arial';
            ctx.fillText('L1: 0.55', xToCanvas(R2) + 30, yToCanvas(l1_2));
            ctx.fillStyle = '#e94560';
            ctx.fillText('KL: 1.34', xToCanvas(R2) - 35, yToCanvas(kl_2) + 5);
            
            // Legend
            const legendX = width - margin.right - 150;
            const legendY = margin.top + 20;
            
            // L1 legend
            ctx.strokeStyle = '#4169E1';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(legendX, legendY);
            ctx.lineTo(legendX + 40, legendY);
            ctx.stroke();
            ctx.fillStyle = '#333';
            ctx.font = '13px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Distance: |0.8 - x|', legendX + 50, legendY + 5);
            
            // KL legend
            ctx.strokeStyle = '#e94560';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(legendX, legendY + 25);
            ctx.lineTo(legendX + 40, legendY + 25);
            ctx.stroke();
            ctx.fillStyle = '#333';
            ctx.fillText('Divergence KL:', legendX + 50, legendY + 25);
            ctx.font = '11px Arial';
            ctx.fillText('0.8 √ó log‚ÇÇ(0.8/x)', legendX + 50, legendY + 40);
            
            // Title
            ctx.fillStyle = '#333';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Comparaison distance absolue vs KL pour D‚ÇÅ id√©al = 80%', width / 2, 25);
        }

        function drawTrainingGraph() {
            const canvas = document.getElementById('trainingGraph');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const margin = { top: 40, right: 40, bottom: 60, left: 70 };
            const graphWidth = width - margin.left - margin.right;
            const graphHeight = height - margin.top - margin.bottom;
            
            // Data points
            const data = [
                { epoch: 0, ce: 3.322 },
                { epoch: 10, ce: 2.000 },
                { epoch: 50, ce: 1.000 },
                { epoch: 100, ce: 0.515 },
                { epoch: 200, ce: 0.152 },
                { epoch: 500, ce: 0.029 }
            ];
            
            const xMax = 500;
            const yMax = 3.5;
            
            const xToCanvas = (x) => margin.left + (x / xMax) * graphWidth;
            const yToCanvas = (y) => height - margin.bottom - (y / yMax) * graphHeight;
            
            // Clear
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, width, height);
            
            // Grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            for (let y = 0; y <= 3.5; y += 0.5) {
                ctx.beginPath();
                ctx.moveTo(margin.left, yToCanvas(y));
                ctx.lineTo(width - margin.right, yToCanvas(y));
                ctx.stroke();
            }
            
            // Axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.stroke();
            
            // Y-axis labels
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            for (let y = 0; y <= 3.5; y += 0.5) {
                ctx.fillText(y.toFixed(1), margin.left - 10, yToCanvas(y));
            }
            
            // X-axis labels
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            for (let x = 0; x <= 500; x += 100) {
                const canvasX = xToCanvas(x);
                ctx.fillText(x, canvasX, height - margin.bottom + 10);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(canvasX, height - margin.bottom);
                ctx.lineTo(canvasX, height - margin.bottom + 5);
                ctx.stroke();
            }
            
            // Labels
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('√âpoque (nombre d\'it√©ration)', width / 2, height - 15);
            
            ctx.save();
            ctx.translate(20, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = 'center';
            ctx.fillText('Entropie crois√©e (bits)', 0, 0);
            ctx.restore();
            
            // Plot line
            ctx.strokeStyle = '#06d6a0';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(xToCanvas(data[0].epoch), yToCanvas(data[0].ce));
            for (let i = 1; i < data.length; i++) {
                ctx.lineTo(xToCanvas(data[i].epoch), yToCanvas(data[i].ce));
            }
            ctx.stroke();
            
            // Plot points
            for (let i = 0; i < data.length; i++) {
                const x = xToCanvas(data[i].epoch);
                const y = yToCanvas(data[i].ce);
                
                ctx.fillStyle = '#06d6a0';
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fill();
                
                ctx.fillStyle = '#333';
                ctx.font = '11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(data[i].ce.toFixed(2), x, y - 15);
            }
            
            // Title
            ctx.fillStyle = '#333';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Diminution de la Cross-Entropy pendant l\'entra√Ænement', width / 2, 20);
        }

        // Initialize
        updateProgress();
    </script>
    <script>
        // Rendre toutes les formules KaTeX apr√®s le chargement de la page
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ],
                throwOnError: false
            });
        });
    </script>
</body>
</body>
</html>